// Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyCc5z1m7qYrBhwosbp7XNQK2vgSjDgz8yE",
  authDomain: "hn-center.firebaseapp.com",
  projectId: "hn-center",
  storageBucket: "hn-center.firebasestorage.app",
  messagingSenderId: "985828603143",
  appId: "1:985828603143:web:defd2e10a864825dc401a2",
  measurementId: "G-RTE2ZPTHM1"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HN-Center Mental Math</title>
<style>
body{
  font-family:Arial, sans-serif;
  text-align:center;
  background:#fff;
  color:#000;
  direction:rtl;
  margin:0;
  padding:0;
}
.container{
  max-width:750px;
  margin:20px auto;
  background:#fff;
  padding:20px;
  border-radius:15px;
  box-shadow:0 0 15px rgba(0,0,0,0.2);
}
input,select,button{
  padding:12px;
  margin:8px;
  border-radius:10px;
  border:1px solid #0297b9;
  font-size:16px;
  width:80%;
}
button{
  width:auto;
  background:#e20e63;
  color:white;
  border:none;
  cursor:pointer;
  font-weight:bold;
  transition:0.3s;
}
button:hover{
  background:#559a3e;
  transform:scale(1.05);
}
.question-container{
  background: linear-gradient(135deg, #eacd2e33, #e20e6333);
  border-radius:12px;
  padding:15px;
  margin:15px 0;
  position:relative;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
.question-icon{
  position:absolute;
  top:10px;
  left:10px;
  width:30px;
  height:30px;
}
.question{
  font-size:24px;
  margin:0;
  color:#0297b9;
}
.options{
  display:flex;
  justify-content:space-between;
  flex-wrap:nowrap;
  gap:10px;
  margin-top:15px;
}
.options button{
  flex:1;
  margin:0 5px;
  padding:12px;
  border-radius:10px;
  font-size:18px;
  background:#eacd2e;
  color:#000;
  border:none;
  transition:0.3s;
}
.options button.correct{background:#559a3e;color:white;}
.options button.incorrect{background:#e20e63;color:white;}
.options button:hover{transform:scale(1.05);}
.hidden{display:none;}
table{
  border-collapse:collapse;
  width:100%;
  margin-top:10px;
}
th,td{
  border:1px solid #0297b9;
  padding:10px;
  text-align:center;
  background:#eacd2e;
  color:#000;
  font-weight:bold;
}
th{background:#e20e63;color:white;}
.nav-btns button{
  width:120px;
  margin:5px;
}
#progressBar{
  width:100%;
  background:#eacd2e;
  border-radius:10px;
  overflow:hidden;
  height:20px;
  margin-top:10px;
}
#progress{
  height:100%;
  width:0%;
  background:#0297b9;
  transition:0.3s;
  border-radius:10px;
}
#timer{
  font-size:18px;
  font-weight:bold;
  margin-top:10px;
  color:#e20e63;
}
</style>
</head>
<body>

<div class="container" id="login">
<h2>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨</h2>
<input type="text" id="studentName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨"><br>
<select id="level">
<option value="0">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 0</option>
<option value="2">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2</option>
</select><br>
<button onclick="startExam()">Ø¯Ø®ÙˆÙ„</button>
<hr>
<h3>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¹Ù„Ù…</h3>
<input type="text" id="teacherName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…"><br>
<input type="password" id="teacherPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"><br>
<button onclick="teacherLogin()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¹Ù„Ù…</button>
<p id="teacherMsg"></p>
</div>

<!-- ØµÙØ­Ø© Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† Ù„Ù„Ø·Ø§Ù„Ø¨ -->
<div class="container hidden" id="exam">
<h2 id="examTitle"></h2>
<p id="timer">Ø§Ù„ÙˆÙ‚Øª: 0:00</p>
<p>Ø§Ù„Ø³Ø¤Ø§Ù„ <span id="qNum"></span> / <span id="totalQ">0</span></p>
<div class="question-container">
  <img src="https://img.icons8.com/color/48/000000/book.png" class="question-icon">
  <div class="question" id="questionText"></div>
</div>
<div class="options" id="options"></div>
<div id="progressBar"><div id="progress"></div></div>
<div class="nav-btns">
<button onclick="prevQ()">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
<button onclick="nextQ()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
</div>
</div>

<!-- ØµÙØ­Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ -->
<div class="container hidden" id="results">
<h2>Ø§Ù„Ù†ØªÙŠØ¬Ø©</h2>
<p>Ø¥Ø¬Ø§Ø¨Ø§Øª ØµØ­ÙŠØ­Ø©: <span id="correctCount"></span></p>
<p>Ø¥Ø¬Ø§Ø¨Ø§Øª Ø®Ø§Ø·Ø¦Ø©: <span id="wrongCount"></span></p>
<p>Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø³ØªØºØ±Ù‚: <span id="timeSpent"></span> Ø«Ø§Ù†ÙŠØ©</p>
<button onclick="location.reload()">Ø¥Ù†Ù‡Ø§Ø¡</button>
</div>

<!-- ØµÙØ­Ø© Ø§Ù„Ù…Ø¹Ù„Ù… -->
<div class="container hidden" id="archive">
<h2>Ø£Ø±Ø´ÙŠÙ Ø§Ù„Ù…Ø¹Ù„Ù…</h2>
<table>
<thead><tr><th>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th><th>Ø§Ù„Ù…Ø³ØªÙˆÙ‰</th><th>ØµØ­</th><th>Ù…Ø¬Ù…ÙˆØ¹</th><th>ÙˆÙ‚Øª</th><th>ØªØ§Ø±ÙŠØ®</th></tr></thead>
<tbody id="archiveBody"></tbody>
</table>
<div class="nav-btns">
<button onclick="clearArchive()">Ù…Ø³Ø­ Ø§Ù„Ø£Ø±Ø´ÙŠÙ</button>
<button onclick="backToLogin()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
</div>

<hr>
<h3>Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</h3>
<select id="modelSelect" onchange="showModel()">
<option value="0">Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 1</option>
<option value="1">Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 2</option>
<option value="2">Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 3</option>
</select>
<div id="modelContainer"></div>
<div class="nav-btns">
<button onclick="prevModel()">Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
<button onclick="nextModel()">Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ§Ù„ÙŠ</button>
</div>

<h3>Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø­Ø§Ù„ÙŠ</h3>
<select id="customLevel">
<option value="0">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 0</option>
<option value="2">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2</option>
</select><br>
<input type="text" id="customQuestion" placeholder="ØµÙŠØºØ© Ø§Ù„Ø³Ø¤Ø§Ù„ Ù…Ø«Ù„Ø§: 2 + 3"><br>
<input type="number" id="customAnswer" placeholder="Ø§Ù„Ø¬ÙˆØ§Ø¨ Ø§Ù„ØµØ­ÙŠØ­"><br>
<button onclick="addTeacherQuestion()">Ø£Ø¶Ù Ø§Ù„Ø³Ø¤Ø§Ù„</button>
<p id="customMsg"></p>
</div>

<script>
let studentName="",level=0,questions=[],answers=[],currentQ=0,startTime,timerInterval;
let currentModel=0;
let models=[[],[],[]]; // 3 Ù†Ù…Ø§Ø°Ø¬ ÙØ§Ø±ØºØ©
if(localStorage.getItem('models')) models=JSON.parse(localStorage.getItem('models'));

// ======= Ø§Ù„Ø·Ø§Ù„Ø¨ =======
function startExam(){
 studentName=document.getElementById('studentName').value.trim();
 level=document.getElementById('level').value;
 if(studentName===""){alert("Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨");return;}
 loadExamQuestions();
 if(questions.length===0){alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ø¦Ù„Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ØŒ Ø§Ù„Ù…Ø¹Ù„Ù… ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¶ÙŠÙ Ø£Ø³Ø¦Ù„Ø©."); return;}
 document.getElementById('login').classList.add('hidden');
 document.getElementById('exam').classList.remove('hidden');
 document.getElementById('examTitle').textContent="Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„Ù…Ø³ØªÙˆÙ‰ "+level;
 document.getElementById('totalQ').textContent=questions.length;
 startTime=Date.now();
 startTimer();
 showQ();
}

function loadExamQuestions(){
 questions=[];
 answers=[];
 let allQs=models.flat();
 let lvlQs=allQs.filter(q=>q.level==level);
 questions=shuffleArray(lvlQs);
 answers=new Array(questions.length).fill(null);
}

function shuffleArray(array){return array.sort(()=>Math.random()-0.5);}
function showQ(){
 let q=questions[currentQ];
 document.getElementById('qNum').textContent=currentQ+1;
 document.getElementById('questionText').textContent=q.text;
 let opsHTML="";
 q.options=q.options||shuffleOptions(q.answer);
 q.options.forEach(o=>{
   let cls="";
   if(answers[currentQ]===o) cls="correct";
   opsHTML+=<button onclick="selectAnswer(${o},this)" class="${cls}">${o}</button>;
 });
 document.getElementById('options').innerHTML=opsHTML;
 updateProgress();
}
function selectAnswer(val,btn){
 answers[currentQ]=val;
 let buttons=document.querySelectorAll('.options button');
 buttons.forEach(b=>b.classList.remove('correct','incorrect'));
 if(val===questions[currentQ].answer){btn.classList.add('correct');}else{btn.classList.add('incorrect');}
}
function prevQ(){if(currentQ>0){currentQ--;showQ();}}
function nextQ(){if(currentQ<questions.length-1){currentQ++;showQ();}else{finishExam();}}
function finishExam(){
 clearInterval(timerInterval);
 let correct=0; questions.forEach((q,i)=>{if(answers[i]===q.answer)correct++;});
 let wrong=questions.length-correct;
 let timeSpent=Math.floor((Date.now()-startTime)/1000);
 document.getElementById('exam').classList.add('hidden');
 document.getElementById('results').classList.remove('hidden');
 document.getElementById('correctCount').textContent=correct;
 document.getElementById('wrongCount').textContent=wrong;
 document.getElementById('timeSpent').textContent=timeSpent;
 let archive=JSON.parse(localStorage.getItem('archive')||"[]");
 archive.push({name:studentName,level:level,correct:correct,total:questions.length,time:timeSpent,date:new Date().toLocaleString()});
 localStorage.setItem('archive',JSON.stringify(archive));
}

// ======= Timer & Progress =======
function startTimer(){
 timerInterval=setInterval(()=>{
   let elapsed=Math.floor((Date.now()-startTime)/1000);
   let min=Math.floor(elapsed/60);
   let sec=elapsed%60;
   document.getElementById('timer').textContent=Ø§Ù„ÙˆÙ‚Øª: ${min}:${sec<10?'0'+sec:sec};
 },1000);
}
function updateProgress(){
 let percent=Math.floor(((currentQ+1)/questions.length)*100);
 document.getElementById('progress').style.width=percent+"%";
}

// ======= Ø§Ù„Ù…Ø¹Ù„Ù… =======
function teacherLogin(){
 let name=document.getElementById('teacherName').value.trim();
 let pass=document.getElementById('teacherPass').value;
 if(name==="Ù†ÙŠØ±Ù…ÙŠÙ†" && pass==="1234"){
   document.getElementById('login').classList.add('hidden');
   document.getElementById('archive').classList.remove('hidden');
   loadArchive();
   showModel();
 }else{document.getElementById('teacherMsg').textContent="Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙˆÙ„ Ù„Ù„Ø£Ø±Ø´ÙŠÙ";}
}

function loadArchive(){
 let archive=JSON.parse(localStorage.getItem('archive')||"[]");
 let html="";
 archive.forEach(a=>{html+=<tr><td>${a.name}</td><td>${a.level}</td><td>${a.correct}</td><td>${a.total}</td><td>${a.time}</td><td>${a.date}</td>;});
 document.getElementById('archiveBody').innerHTML=html;
}
function clearArchive(){localStorage.removeItem('archive'); loadArchive();}
function backToLogin(){document.getElementById('archive').classList.add('hidden'); document.getElementById('login').classList.remove('hidden');}

// ======= Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ù…Ø¹Ù„Ù… =======
function showModel(){
 let container=document.getElementById('modelContainer');
 container.innerHTML="";
 let model=models[currentModel]||[];
 if(model.length===0){container.innerHTML="<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ø¦Ù„Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬.</p>"; return;}
 let html="<table><tr><th>Ø§Ù„Ø³Ø¤Ø§Ù„</th><th>Ø§Ù„Ù…Ø³ØªÙˆÙ‰</th><th>Ø§Ù„Ø¬ÙˆØ§Ø¨</th></tr>";
 model.forEach((q,i)=>{html+=<tr><td>${q.text}</td><td>${q.level}</td><td>${q.answer}</td></tr>;});
 html+="</table>";
 container.innerHTML=html;
 document.getElementById('modelSelect').value=currentModel;
}
function prevModel(){if(currentModel>0){currentModel--; showModel();}}
function nextModel(){if(currentModel<models.length-1){currentModel++; showModel();}}

function addTeacherQuestion(){
 let lvl=document.getElementById('customLevel').value;
 let txt=document.getElementById('customQuestion').value.trim();
 let ans=parseInt(document.getElementById('customAnswer').value);
 if(!txt || isNaN(ans)){alert("Ø§Ø¯Ø®Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„ ÙˆØ§Ù„Ø¬ÙˆØ§Ø¨"); return;}
 if(!models[currentModel]) models[currentModel]=[];
 models[currentModel].push({text:txt,answer:ans,level:parseInt(lvl)});
 localStorage.setItem('models',JSON.stringify(models));
 document.getElementById('customQuestion').value="";
 document.getElementById('customAnswer').value="";
 document.getElementById('customMsg').textContent="ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ø¤Ø§Ù„!";
 showModel();
}
function showModel(){
 let container=document.getElementById('modelContainer');
 container.innerHTML="";
 let model=models[currentModel]||[];
 if(model.length===0){container.innerHTML="<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ø¦Ù„Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬.</p>"; return;}
 let html="<table><tr><th>Ø§Ù„Ø³Ø¤Ø§Ù„</th><th>Ø§Ù„Ù…Ø³ØªÙˆÙ‰</th><th>Ø§Ù„Ø¬ÙˆØ§Ø¨</th><th>Ø­Ø°Ù</th></tr>";
 model.forEach((q,i)=>{
   html+=`<tr>
     <td>${q.text}</td>
     <td>${q.level}</td>
     <td>${q.answer}</td>
     <td><button onclick="deleteQuestion(${i})">ğŸ—‘</button></td>
   </tr>`;
 });
 html+="</table>";
 container.innerHTML=html;
 document.getElementById('modelSelect').value=currentModel;
}

// Ø¯Ø§Ù„Ø© Ø§Ù„Ø­Ø°Ù
function deleteQuestion(index){
 models[currentModel].splice(index,1);
 saveModels(); // ÙŠØ­ÙØ¸ Ø¹Ù„Ù‰ ÙØ§ÙŠØ±Ø¨ÙŠØ²
 showModel();
}

// ======= Ø®ÙŠØ§Ø±Ø§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© =======
function shuffleOptions(correct){
 let opts=[correct];
 while(opts.length<4){
   let d=correct+Math.floor(Math.random()*5)-2;
   if(d<1)d=1;if(d>99)d=99;
   if(!opts.includes(d))opts.push(d);
 }
 return opts.sort(()=>Math.random()-0.5);
}
</script>
</body>
</html>

