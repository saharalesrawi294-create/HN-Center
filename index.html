<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Ù„Ø¹Ø¨Ø© Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø°Ù‡Ù†ÙŠ</title>
<style>
  body{font-family:Arial,sans-serif;background:#f9f9f9;color:#222;margin:0;padding:20px;text-align:center}
  h1{color:#0066cc}
  .problem{font-size:32px;margin:20px 0}
  input{padding:8px;font-size:20px;width:120px;text-align:center}
  button{padding:10px 18px;margin:10px;border:none;background:#0066cc;color:#fff;border-radius:6px;cursor:pointer}
  #results{margin-top:20px;text-align:right;max-width:500px;margin-inline:auto;background:#fff;padding:10px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.1)}
</style>
</head>
<body>
  <h1>ğŸ”¥ ØªØ­Ø¯ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø°Ù‡Ù†ÙŠ</h1>
  <div>
    <label>Ø§Ø³Ù…Ùƒ: <input id="playerName" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ"></label>
  </div>
  <div class="problem" id="problem">Ø§Ø¶ØºØ· Ø§Ø¨Ø¯Ø£</div>
  <input id="answer" type="number" placeholder="Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©" disabled>
  <div>
    <button id="startBtn">Ø§Ø¨Ø¯Ø£</button>
    <button id="submitBtn" disabled>Ø£Ø¬Ø¨</button>
  </div>
  <p id="scoreText">Ø§Ù„Ù†Ù‚Ø§Ø·: 0</p>

  <h2>ğŸ“Š Ø¢Ø®Ø± Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h2>
  <div id="results">Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
  <script>
    // âš ï¸ Ø§Ù„ØµÙ‚ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª firebaseConfig ØªØ¨Ø¹Ùƒ Ù‡ÙˆÙ† (Ù…Ù† Firebase Console)
    const firebaseConfig = {
      apiKey: "PASTE_HERE",
      authDomain: "PASTE_HERE",
      projectId: "PASTE_HERE",
      storageBucket: "PASTE_HERE",
      messagingSenderId: "PASTE_HERE",
      appId: "PASTE_HERE"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Ø¹Ù†Ø§ØµØ±
    const problemEl = document.getElementById("problem");
    const answerEl = document.getElementById("answer");
    const scoreText = document.getElementById("scoreText");
    const resultsEl = document.getElementById("results");
    let current, score=0, total=0;

    function newProblem(){
      let a=Math.floor(Math.random()*10), b=Math.floor(Math.random()*10);
      current={a,b,result:a+b};
      problemEl.textContent=`${a} + ${b} = ?`;
      answerEl.disabled=false;
      document.getElementById("submitBtn").disabled=false;
      answerEl.value="";
      answerEl.focus();
    }

    document.getElementById("startBtn").onclick=()=>{
      score=0; total=0;
      scoreText.textContent="Ø§Ù„Ù†Ù‚Ø§Ø·: 0";
      newProblem();
    };

    document.getElementById("submitBtn").onclick=()=>{
      const val=parseInt(answerEl.value);
      total++;
      if(val===current.result) score++;
      scoreText.textContent=`Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}/${total}`;
      // Ø­ÙØ¸ Ø¨Ø§Ù„Ù€ Firebase
      const name=document.getElementById("playerName").value||"Ù…Ø¬Ù‡ÙˆÙ„";
      db.collection("results").add({
        name, q:`${current.a}+${current.b}`, given:val, ok:(val===current.result),
        score, total, date:new Date().toISOString()
      });
      newProblem();
      loadResults();
    };

    function loadResults(){
      db.collection("results").orderBy("date","desc").limit(10).get().then(snap=>{
        resultsEl.innerHTML="";
        snap.forEach(doc=>{
          const d=doc.data();
          resultsEl.innerHTML+=`<div>ğŸ‘¤ ${d.name} â€” ${d.q} = ${d.given} 
            [${d.ok? "âœ… ØµØ­":"âŒ ØºÙ„Ø·"}] â€” Ù†Ù‚Ø§Ø·: ${d.score}/${d.total}</div>`;
        });
      });
    }
    loadResults();
  </script>
</body>
</html>
